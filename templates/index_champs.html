{% extends "base.html" %}

{% block title %}The Blue Alliance{% endblock %}

{% block content %}

<div class="container">
  <div class="row">
    <div class="col-xs-12">
      <h2>Welcome to The Blue Alliance's coverage of the 2017 <i>FIRST</i> Championship!</h2>
      <h4>More info at <a href="https://www.firstchampionship.org">firstchampionship.org</a></h4>
    </div>

    <div class="col-xs-12 visible-xs">
      <a class="btn btn-block btn-success" href="/watch/champs"><span class="glyphicon glyphicon-facetime-video"></span> Watch #FIRSTChampLIVE!</a>
      <a class="btn btn-block btn-default" href="/watch/champs-all"><span class="glyphicon glyphicon-facetime-video"></span> Watch All Championship Streams!</a>
    </div>
    <div class="col-md-8 col-lg-6 col-md-offset-2 col-lg-offset-3 hidden-xs">
      <div class="btn-group btn-group-block-2">
        <a class="btn btn-success" href="/watch/champs"><span class="glyphicon glyphicon-facetime-video"></span> Watch #FIRSTChampLIVE!</a>
        <a class="btn btn-default" href="/watch/champs-all"><span class="glyphicon glyphicon-facetime-video"></span> Watch All Championship Streams!</a>
      </div>
    </div>

    <div class="col-xs-12">
      <div class="row">
        <div class="col-xs-12 col-md-6">
          <h3>
            <span class="glyphicon glyphicon-map-marker"></span> Houston
            <a class="btn btn-primary btn-sm pull-right" href="https://www.facebook.com/events/1468298706578930/"><span class="glyphicon glyphicon-calendar"></span> RSVP on Facebook</a>
          </h3>
          {% with hou_events as events %}
            {% include "event_partials/event_table.html" %}
          {% endwith %}
        </div>
        <div class="col-xs-12 col-md-6">
          <h3>
            <span class="glyphicon glyphicon-map-marker"></span> St. Louis
            <a class="btn btn-primary btn-sm pull-right" href="https://www.facebook.com/events/469106486766522/"><span class="glyphicon glyphicon-calendar"></span> RSVP on Facebook</a>
          </h3>
          {% with stl_events as events %}
            {% include "event_partials/event_table.html" %}
          {% endwith %}
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-xs-12">
      <h2 class="end_header">{{year}} Stats Recap{% if num_matches %} <small>{{num_matches.data}} Matches Played</small>{% endif %}</h2>

      {% if match_highscore %}
        <div class="row">
          <div class="col-xs-12">
            <h3>Highest Scoring Match{% if match_highscore.data|length > 1 %}es{% endif %}</h3>
            {% for match in  match_highscore.data %}
              <h4><a href="/match/{{match.key_name}}">{{ match.event_name }} <small>{{ match.verbose_name }}</small></a></h4>
              <table class="match-table insights-table">
                <thead>
                  <tr class="key">
                    <th colspan="{{match.alliances.items.0.1.teams|length}}">Teams</th>
                    <th>Score</th>
                  </tr>
                </thead>
                <tbody>
                  {% for items in match.alliances.items reversed %}
                  <tr>
                    {% for team in items.1.teams %}
                    <td class="{{items.0}}{% ifequal match.winning_alliance items.0 %} winner{% endifequal %}"><a href="/team/{{team|digits}}/{{selected_year}}">{{team|digits}}</a></td>
                    {% endfor %}
                    <td class="{{items.0}}Score{% ifequal match.winning_alliance items.0 %} winner{% endifequal %}">{% ifequal items.1.score "-1" %}?{% else %}{{ items.1.score }}{% endifequal %}</td>
                  </tr>
                  {% endfor %}
                </tbody>
              </table>
            {% endfor %}
          </div>
        </div>
      {% endif %}

      {% if match_averages_by_week %}
        <h3>Average Match Score By Week</h3>
        {% if elim_match_averages_by_week %}
          <div class="chart-key"><div class="color-key blue-color-key"></div><div class="chart-key-text">All Match Averages</div></div>
          <div class="chart-key"><div class="color-key green-color-key"></div><div class="chart-key-text">Elim Match Averages</div></div>
          <figure style="width: 90%; height: 300px;" id="elim-match-average-chart"></figure>
          <div id="elim-match-average" class="xcharts-data xcharts-line-data">[{{ match_averages_by_week.data_json|safe }}, {{ elim_match_averages_by_week.data_json|safe }}]</div>
        {% else %}
          <figure style="width: 90%; height: 300px;" id="match-average-chart"></figure>
          <div id="match-average" class="xcharts-data xcharts-line-data">[{{ match_averages_by_week.data_json|safe }}]</div>
        {% endif %}
        <br><br>
      {% endif %}

      {% if score_distribution %}
        <h3>Match Score Distribution <small>Percent of Matches vs. Match Score</small></h3>
        {% if elim_score_distribution %}
          <div class="chart-key"><div class="color-key blue-color-key"></div><div class="chart-key-text">All Match Scores</div></div>
          <div class="chart-key"><div class="color-key green-color-key"></div><div class="chart-key-text">Elim Match Scores</div></div>
          <figure style="width: 90%; height: 300px;" id="elim-match-distribution-chart"></figure>
          <div id="elim-match-distribution" class="xcharts-data xcharts-bar-data">[{{ score_distribution.data_json|safe }}, {{ elim_score_distribution.data_json|safe }}]</div>
        {% else %}
          <figure style="width: 90%; height: 300px;" id="match-distribution-chart"></figure>
          <div id="match-distribution" class="xcharts-data xcharts-bar-data">[{{ score_distribution.data_json|safe }}]</div>
        {% endif %}
        <br><br>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}
